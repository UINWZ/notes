# 版本控制

[TOC]

# 1. 常见的版本控制软件
1. cvs
2. svn
3. ClearCase    IBM的
4. vss    微软的
5. git 由很多台电脑组成了一个整体

# 2. svn 单用户 管理代码

1. 让当前工作空间与svn服务器建立关联


	- 首先需要知道服务器仓库地址,然后到自己的工作空间,右键`SVN-Checkout`选项,输入仓库地址(里面的主机名称改为ip地址,PPP适配器),
  点OK.输入用户名密码即可得到服务器上的代码,并且该工作空间文件夹会打上一个绿色的勾.

2. 如果发现当前工作空间有一个.svn目录就说明当前工作空间与仓库建立关联
3. 当前工作空间会有一个绿色的勾


4. 创建一个代码文件(eg:Test.java),右键点击add,则代码文件的图标会变成一个蓝色的`+`
,表示计划把文件加入到版本控制库中.
5. 把文件提交到版本库

	- 代码文件,右键`SVN-Commit`提交

# 3. 版本库的备份与还原
  默认仓库的位置在C盘的Repositories下(安装的时候让你选择的那个目录),可以拷贝一份拿来备份.上传到云盘等.

# 4. SVN软件的基本使用
1. 查看提交日志

	* 代码文件右键`TortoiseSVN`->`show log`,即可查看该代码文件的所有提交过的记录,提交者,时间,注释等信息.
	* 点击下面的窗口,可以查看每一次提交的代码,点进去还可以查看这一次提交的代码和上一次有什么不同.


2. 清除账户信息

	* 如果之前提交代码的时候勾选了记住密码,则下一次不会要求再次输入用户名和密码.现在可以点击`TortoiseSVN`->`Settings`->`SavedData`进行`Clear`.

3. 安装了`VisualSVN Server`之后,开机不用打开这个软件,直接就可以提交代码,直接浏览器就可以访问`https://127.0.0.1/`.(前提是开启了VisualSVN Server服务)

# 5. SVN多用户代码的控制

  - 多个用户创建不同的工作空间,在不同的地方.
  - 首先需要与仓库进行关联
  - 其次写完代码提交,	需要`SVN-Update`,这个表示更新仓库的代码到本地来.
  - 当遇到黄色三角形感叹号时,表示提交的代码有冲突.svn不知道用哪一份,此时点击右键,选择`TortoiseSVN`->`Edit conflicts`,会显示冲突的部分,此时编辑即可.上面2个窗口表示冲突的代码,下面是最终决定用哪个代码的窗口.如下所示:

   ![](http://p1.bqimg.com/567571/61dfb81c292d3743.png)

   选中下面的窗口有问号的代码行,选择上面窗口中你觉得该用那行的代码,右键`use this text block`.这时那一行的代码就确定了.

  - SVN不是专门用来解决冲突的,有冲突的话,解决起来比较麻烦.
  - 提交代码之前要先更新一下,这样能避免冲突.
  - 在公司一般都是分模块了的,除了一些Utils是公共的.

# 6. SVN常见图标

  - 绿色勾  代表和服务已经建立关联 或者  更新成功等
  - 蓝色?  代表服务器不知道有这个文件
  - 蓝色+  代表计划加入到版本库中
  - 黄色!  代表遇到了冲突
  - 红色!  代表修改了这个文件,需要提交到版本控制库中
  - 灰色勾  代表文件只读
  - 锁在开发中慎用

# 7. SVN原则

  - **先更新再提交**
  - 多提交,经常提交,经常提交!!!  每次提交的间隔短一些,加了一个小功能或者UI就提交一次.
  - 不要提交不能通过编译的代码    Android只要是有一个编译时错误,就不能右键部署.
  - 每次提交必须书写明晰的标注
  - 提交时注意不要提交本地自动生成的文件   Android比如`bin`和`gen`目录

	* 选中`bin`和`gen`目录,右键`TortoiseSVN`->`Unversion and add to ignore list`->`delete and ignore 2 items by name`

  - 不要提交自己不明白的代码
  - **慎用锁定功能**

# 8. 使用SVN管理Android项目

>使用ignore忽略不想提交的目录

1. 使用客户端软件
2. 使用eclipse插件

# 9. svn的标准目录结构

1. trunk 标准目录结构
2. branches 分支   一般用来修复bug
3. tags 里程碑   比如发布了一个稳定的版本